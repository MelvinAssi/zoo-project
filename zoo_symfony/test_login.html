<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Test Login JWT</title>
</head>
<body>
    <h1>Test de connexion avec JWT + Cookie</h1>

    <button id="loginBtn">Se connecter</button>
    <button id="protectedBtn">Appel route prot√©g√©e</button>

    <script>
        const API_URL = 'http://127.0.0.1:8000'; // Modifie si ton serveur n'est pas √† cette adresse

        document.getElementById('loginBtn').addEventListener('click', () => {
            fetch(`${API_URL}/api/login`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                credentials: 'include', // üëà n√©cessaire pour accepter les cookies
                body: JSON.stringify({
                    email: 'melvin@example.com',
                    password: 'AzertyAzerty25' // üîí Mets le bon mot de passe ici
                })
            })
            .then(res => res.json())
            .then(data => {
                console.log('R√©ponse login:', data);
                alert('Connexion r√©ussie (v√©rifie la console)');
            })
            .catch(err => console.error(err));
        });
        
        document.getElementById('protectedBtn').addEventListener('click', () => {
            fetch('http://127.0.0.1:8000/api/protected', {
                method: 'POST',
                credentials: 'include', // Ceci permet d'envoyer les cookies
            })
            .then(res => res.json())
            .then(data => {
                console.log('R√©ponse prot√©g√©e:', data);
                alert('Donn√©es prot√©g√©es r√©cup√©r√©es !');
            })
            .catch(err => console.error('Erreur d\'authentification ou autre', err));
        });
    </script>
</body>
</html>
